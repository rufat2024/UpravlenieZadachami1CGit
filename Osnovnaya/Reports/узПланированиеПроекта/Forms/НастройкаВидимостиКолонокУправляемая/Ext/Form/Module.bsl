
&НаКлиенте
Процедура Применить(Команда)
	Закрыть(Истина);
КонецПроцедуры

&НаКлиенте
Процедура ПриОткрытии(Отказ)
	тдПроект = ВладелецФормы.тдПроект;
	ТаблицаКолонок.Очистить();
	НоваяСтрока = ТаблицаКолонок.Добавить();
	НоваяСтрока.Значение = ВладелецФормы.НомерКолонкиДлительность;
	НоваяСтрока.Ключ = "НомерКолонкиДлительность";
	НоваяСтрока.Представление = НСтр("ru = 'Длительность'");
	НоваяСтрока.Пометка = тдПроект.Область(1, ВладелецФормы.НомерКолонкиДлительность, 1,ВладелецФормы.НомерКолонкиДлительность).Видимость;
	
	НоваяСтрока = ТаблицаКолонок.Добавить();
	НоваяСтрока.Значение = ВладелецФормы.НомерКолонкиНачало;
	НоваяСтрока.Представление = НСтр("ru = 'Начало (план)'");
	НоваяСтрока.Ключ = "НомерКолонкиНачало";
	НоваяСтрока.Пометка = тдПроект.Область(1, ВладелецФормы.НомерКолонкиНачало, 1,ВладелецФормы.НомерКолонкиНачало).Видимость;
	
	НоваяСтрока = ТаблицаКолонок.Добавить();
	НоваяСтрока.Значение = ВладелецФормы.НомерКолонкиОкончание;
	НоваяСтрока.Ключ = "НомерКолонкиОкончание";
	НоваяСтрока.Представление = НСтр("ru = 'Окончание (план)'");
	НоваяСтрока.Пометка = тдПроект.Область(1, ВладелецФормы.НомерКолонкиОкончание, 1,ВладелецФормы.НомерКолонкиОкончание).Видимость;
	
	НоваяСтрока = ТаблицаКолонок.Добавить();
	НоваяСтрока.Значение = ВладелецФормы.НомерКолонкиПроцентЗавершения;
	НоваяСтрока.Ключ = "НомерКолонкиПроцентЗавершения";
	НоваяСтрока.Представление = НСтр("ru = '% завершения'");
	НоваяСтрока.Пометка = тдПроект.Область(1, ВладелецФормы.НомерКолонкиПроцентЗавершения, 1,ВладелецФормы.НомерКолонкиПроцентЗавершения).Видимость;
	
	НоваяСтрока = ТаблицаКолонок.Добавить();
	НоваяСтрока.Значение = ВладелецФормы.НомерКолонкиНачалоФакт;
	НоваяСтрока.Ключ = "НомерКолонкиНачалоФакт";
	НоваяСтрока.Представление = НСтр("ru = 'Начало (факт)'");
	НоваяСтрока.Пометка = тдПроект.Область(1, ВладелецФормы.НомерКолонкиНачалоФакт, 1,ВладелецФормы.НомерКолонкиНачалоФакт).Видимость;
	
	НоваяСтрока = ТаблицаКолонок.Добавить();
	НоваяСтрока.Значение = ВладелецФормы.НомерКолонкиОкончаниеФакт;
	НоваяСтрока.Ключ = "НомерКолонкиОкончаниеФакт";
	НоваяСтрока.Представление = НСтр("ru = 'Окончание (факт)'");
	НоваяСтрока.Пометка = тдПроект.Область(1, ВладелецФормы.НомерКолонкиОкончаниеФакт, 1,ВладелецФормы.НомерКолонкиОкончаниеФакт).Видимость;
	
	НоваяСтрока = ТаблицаКолонок.Добавить();
	НоваяСтрока.Значение = ВладелецФормы.НомерКолонкиРесурсыПредставление;
	НоваяСтрока.Ключ = "НомерКолонкиРесурсыПредставление";
	НоваяСтрока.Представление = НСтр("ru = 'Ресурсы'");
	НоваяСтрока.Пометка = тдПроект.Область(1, ВладелецФормы.НомерКолонкиРесурсыПредставление, 1,ВладелецФормы.НомерКолонкиРесурсыПредставление).Видимость;
	
	НоваяСтрока = ТаблицаКолонок.Добавить();
	НоваяСтрока.Значение = ВладелецФормы.НомерКолонкиЗатраты;
	НоваяСтрока.Ключ = "НомерКолонкиЗатраты";
	НоваяСтрока.Представление = НСтр("ru = 'Затраты (итог)'");
	НоваяСтрока.Пометка = тдПроект.Область(1, ВладелецФормы.НомерКолонкиЗатраты, 1,ВладелецФормы.НомерКолонкиЗатраты).Видимость;
	
	НоваяСтрока = ТаблицаКолонок.Добавить();
	НоваяСтрока.Значение = ВладелецФормы.НомерКолонкиДопЗатраты;
	НоваяСтрока.Ключ = "НомерКолонкиДопЗатраты";
	НоваяСтрока.Представление = НСтр("ru = 'Доп. затраты'");
	НоваяСтрока.Пометка = тдПроект.Область(1, ВладелецФормы.НомерКолонкиДопЗатраты, 1,ВладелецФормы.НомерКолонкиДопЗатраты).Видимость;
	
	
	НоваяСтрока = ТаблицаКолонок.Добавить();
	НоваяСтрока.Значение = ВладелецФормы.НомерКолонкиСтоимость;
	НоваяСтрока.Ключ = "НомерКолонкиСтоимость";
	НоваяСтрока.Представление = НСтр("ru = 'Стоимость (итог)'");
	НоваяСтрока.Пометка = тдПроект.Область(1, ВладелецФормы.НомерКолонкиСтоимость, 1,ВладелецФормы.НомерКолонкиСтоимость).Видимость;
	
	НоваяСтрока = ТаблицаКолонок.Добавить();
	НоваяСтрока.Значение = ВладелецФормы.НомерКолонкиДопСтоимость;
	НоваяСтрока.Ключ = "НомерКолонкиДопСтоимость";
	НоваяСтрока.Представление = НСтр("ru = 'Доп. стоимость'");
	НоваяСтрока.Пометка = тдПроект.Область(1, ВладелецФормы.НомерКолонкиДопСтоимость, 1,ВладелецФормы.НомерКолонкиДопСтоимость).Видимость;
	
	НоваяСтрока = ТаблицаКолонок.Добавить();
	НоваяСтрока.Значение = ВладелецФормы.НомерКолонкиЗатратыФакт;
	НоваяСтрока.Ключ = "НомерКолонкиЗатратыФакт";
	НоваяСтрока.Представление = НСтр("ru = 'Затраты (факт)'");
	НоваяСтрока.Пометка = тдПроект.Область(1, ВладелецФормы.НомерКолонкиЗатратыФакт, 1,ВладелецФормы.НомерКолонкиЗатратыФакт).Видимость;
	
	НоваяСтрока = ТаблицаКолонок.Добавить();
	НоваяСтрока.Значение = ВладелецФормы.НомерКолонкиСтоимостьФакт;
	НоваяСтрока.Ключ = "НомерКолонкиСтоимостьФакт";
	НоваяСтрока.Представление = НСтр("ru = 'Стоимость (факт)'");
	НоваяСтрока.Пометка = тдПроект.Область(1, ВладелецФормы.НомерКолонкиСтоимостьФакт, 1,ВладелецФормы.НомерКолонкиСтоимостьФакт).Видимость;
	
	ТаблицаКолонок.Сортировать("Значение Возр");
	
	пСоответствиеПозицийПоИндексамТаблицы = Новый Соответствие;
	Для Каждого ЭлементСписка из ТаблицаКолонок Цикл
		ЭлементСписка.ПервоначальныйИндекс = ТаблицаКолонок.Индекс(ЭлементСписка);
		пСоответствиеПозицийПоИндексамТаблицы.Вставить(ЭлементСписка.ПервоначальныйИндекс, ЭлементСписка.Значение);
	КонецЦикла;
	СоответствиеПозицийПоИндексамТаблицы = Новый ФиксированноеСоответствие(пСоответствиеПозицийПоИндексамТаблицы);
	
	пСтруктураПозиций = Новый Структура;
	пСтруктураПозиций.Вставить("НомерКолонкиДлительность", ВладелецФормы.НомерКолонкиДлительность);
	пСтруктураПозиций.Вставить("НомерКолонкиНачало", ВладелецФормы.НомерКолонкиНачало);
	пСтруктураПозиций.Вставить("НомерКолонкиОкончание", ВладелецФормы.НомерКолонкиОкончание);
	пСтруктураПозиций.Вставить("НомерКолонкиПроцентЗавершения", ВладелецФормы.НомерКолонкиПроцентЗавершения);
	пСтруктураПозиций.Вставить("НомерКолонкиНачалоФакт", ВладелецФормы.НомерКолонкиНачалоФакт);
	пСтруктураПозиций.Вставить("НомерКолонкиОкончаниеФакт", ВладелецФормы.НомерКолонкиОкончаниеФакт);
	пСтруктураПозиций.Вставить("НомерКолонкиРесурсыПредставление", ВладелецФормы.НомерКолонкиРесурсыПредставление);
	пСтруктураПозиций.Вставить("НомерКолонкиЗатраты", ВладелецФормы.НомерКолонкиЗатраты);
	пСтруктураПозиций.Вставить("НомерКолонкиДопЗатраты", ВладелецФормы.НомерКолонкиДопЗатраты);
	пСтруктураПозиций.Вставить("НомерКолонкиСтоимость", ВладелецФормы.НомерКолонкиСтоимость);
	пСтруктураПозиций.Вставить("НомерКолонкиДопСтоимость", ВладелецФормы.НомерКолонкиДопСтоимость);
	пСтруктураПозиций.Вставить("НомерКолонкиЗатратыФакт", ВладелецФормы.НомерКолонкиЗатратыФакт);
	пСтруктураПозиций.Вставить("НомерКолонкиСтоимостьФакт", ВладелецФормы.НомерКолонкиСтоимостьФакт);
	
	пСтруктураПозиций.Вставить("НомерКолонкиНазвание", ВладелецФормы.НомерКолонкиНазвание);
	пСтруктураПозиций.Вставить("НомерКолонкиДиаграммыГанта", ВладелецФормы.НомерКолонкиДиаграммыГанта);
	пСтруктураПозиций.Вставить("НомерКолонкиИмяРисунка", ВладелецФормы.НомерКолонкиИмяРисунка);
	пСтруктураПозиций.Вставить("НомерКолонкиРодитель", ВладелецФормы.НомерКолонкиРодитель);
	пСтруктураПозиций.Вставить("НомерКолонкиПредшествинники", ВладелецФормы.НомерКолонкиПредшествинники);
	пСтруктураПозиций.Вставить("НомерКолонкиДлительность", ВладелецФормы.НомерКолонкиДлительность);
	пСтруктураПозиций.Вставить("НомерКолонкиНачалоПриРучномВводе", ВладелецФормы.НомерКолонкиНачалоПриРучномВводе);
	пСтруктураПозиций.Вставить("НомерКолонкиРесурсы", ВладелецФормы.НомерКолонкиРесурсы);
	пСтруктураПозиций.Вставить("НомерКолонкиGUID", ВладелецФормы.НомерКолонкиGUID);
	пСтруктураПозиций.Вставить("НомерКолонкиЗадача", ВладелецФормы.НомерКолонкиЗадача);
	пСтруктураПозиций.Вставить("НомерКолонкиОписание", ВладелецФормы.НомерКолонкиОписание);
	пСтруктураПозиций.Вставить("НомерКолонкиДатаОграничения", ВладелецФормы.НомерКолонкиДатаОграничения);
	пСтруктураПозиций.Вставить("НомерКолонкиВидОграничения", ВладелецФормы.НомерКолонкиВидОграничения);
	пСтруктураПозиций.Вставить("НомерКолонкиВеха", ВладелецФормы.НомерКолонкиВеха);

	СтруктураПозиций = Новый ФиксированнаяСтруктура(пСтруктураПозиций);
КонецПроцедуры

&НаКлиенте
Процедура ТаблицаКолонокВыбор(Элемент, ВыбраннаяСтрока, Поле, СтандартнаяОбработка)
	СтандартнаяОбработка = ложь;
КонецПроцедуры

&НаКлиенте
Процедура ПрименитьИЗакрыть(Команда)
	Закрыть(Истина);
КонецПроцедуры

